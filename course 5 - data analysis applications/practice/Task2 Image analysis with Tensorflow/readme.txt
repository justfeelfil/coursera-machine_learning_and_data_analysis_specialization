Применение предобученной на imagenet нейронной сети для практической задачи классификации автомобилей с помощью библиотеки TensorFlow.

Данные это часть выборки Cars Dataset (link). Исходный датасет содержит 16,185 изображений автомобилей, принадлежащих к 196 классам. Данные разделены на 8,144 тренировочных и
8,041 тестовых изображений, при этом каждый класс разделён приблизительно поровну между тестом и трейном. Все классы уровня параметров Марка, Год, Модель и др. (например,
2012 Tesla Model S or 2012 BMW M3 coupe). В нашем же случае в train 204 изображения, и в test — 202 изображения.

Задание 1.
Для начала нужно запустить готовую модель vgg16, предобученную на imagenet. Модель обучена с помощью caffe и сконвертирована в формат tensorflow - vgg16_weights.npz. Скрипт, иллюстрирующий
применение этой модели к изображению, находится внутри ноутбука vgg16.ipynb и возвращает топ-5 классов из imagenet, а так же уверенность в этих классах.

Задание: Загрузите уверенность первого класса для изображения train/00002.jpg с точностью до 1го знака после запятой.


Задание 2.
Научитесь извлекать fc2 слой. Для этого нужно модифицировать process_image, чтобы вместо последнего слоя извлекались выходы fc2.

Задание: Посчитайте fc2 для картинки train/00002.jpg. Запишите первые 20 компонент (каждое число с новой строки, т.е. в загружаемом файле должно получиться 20 строк).


Задание 3.
Теперь необходимо дообучить классификатор на нашей базе. В качестве бейзлайна предлагается воспользоваться классификатором svm из пакета sklearn.

- Модифицировать функцию get_features и добавить возможность вычислять fc2. (Мы это уже сделали в process_image).
- Применить get_features, чтобы получить X_test и Y_test.
- Воспользоваться классификатором, SVC с random_state=0.

Задание: Сколько правильных ответов получается на валидационной выборке из папки test? Запишите в файл.